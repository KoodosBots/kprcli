/*!
 * @package Lightning Autofill
 * @author tohodo.com
 * @copyright (c) 2010-2024
 * @link https://www.tohodo.com/autofill/
 */
const e=5,t=120,n=500,r=5e3,i=Date.now();var l,a,s,o,c,u,f,d,h,p,g,m,b,y,v,w,E,C,k,x,T,A,S,N,W,M,L,O,D,R,$,I,z,H,U,P,q,B,j,F,J,K,V,G,Y,Z,Q,_,X,ee,te,ne,re,ie,le,ae,se,oe=document,ce=oe.documentElement,ue="about:blank"===location.href,fe=self===top,de=ue?parent.location:location,he=window,pe=navigator.userAgent.toLowerCase(),ge=pe.includes(function(e){let t;try{t=e?atob([...e.slice(0,-1)].reverse().join("")).trim():""}catch(e){}return t||""}("Ng3bmVmcpZWD=")),me=ge?browser:chrome,be=me.runtime,ye=be.getManifest(),ve="MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC+KdvKguT0dbNJSmbd5jSmboJiwqQCViMPVB7Fg8W6BbpDC59x9Y/RhqFfST66z7w2bM+Wwm1KSC6/wClckIWgTcoD1ZPQ22iuoWdxGEZ1QwrsfJoo3iZ7f7bFqnVvW1mXX9tssFJMyzpjcS0h3zAGuJy0eG9OmL3pWa446sCPXwIDAQAB",we=ye.name,Ee=me.i18n,Ce=me.storage,ke="abcdefghijklmnopqrstuvwxyz",xe=/ *> *|\W/g,Te=/^(all|unfiled|manage\.\.\.|new\.\.\.)$/i,Ae=/^# .*$/gm,Se=/([^\w.,>~#+-])/g,Ne=/[{}]/g,We=/(.+)\/.+$/,Me=/^.+?\//,Le=/"/g,Oe=/\\"/g,De=/(?<!\\)"/g,Re=/\\=/g,$e=/["\\]/g,Ie=new RegExp([1,4,19,0].map((e=>ke[e].toUpperCase())).join("")+"|\\W",ke[6]),ze=/\{[nv]\d+\}/g,He=/\b(\d+)\.(\d+)\b/g,Ue=/\s|<.+?>|&nbsp;/gi,Pe=/\{(-?\d+).+/,qe=/``(-?\d+)``/g,Be=/.+?([+-]\d+)\}/,je=/(\+\+|\+\d+|--|-\d+)\}/,Fe=/\{-?\d+(\+\+|\+\d+|--|-\d+)\}/g,Je=/[\r\n]+/g,Ke=/\\(?!\\)/g,Ve=/[\^\$]/g,Ge=/\n/g,Ye=/\v\vn/g,Ze=/\\n/g,Qe=/\\\\n/g,_e=/\D+/g,Xe=/\W+/g,et=/\n+/g,tt=/\{#(-?\d+)-(\d+)\}/,nt=/\+/g,rt=/\{[#$aA%]\d*\}/g,it=/^\/.*\/[dgimsuvy]*$/,lt=/[gm]/g,at=/([$^?+*\\|(){}\[\]])/g,st=/^(about|javascript)/i,ot=/<script.+?<\/script>/gi,ct=/(?<!\\)".*?(?<!\\)"/g,ut=/^[\d+](\|\d+)*$/,ft=/[^\d ]/,dt=/[^\d |]/,ht=/ +/g,pt=/ {2,}/g,gt=/HEAD|LINK|SCRIPT|STYLE|TITLE/,mt=/\s*.+\n/,bt=/``(\([^)]+\))``/g,yt=/{``\(\)``}/g,vt=/^([01]?!|)$/,wt=/^(\w+) = (.+)$/,Et=/\{_(\w+)\}/g,Ct=/\{@(\w+)\}/g,kt=/\s/g,xt=/^www\d*?\./,Tt="{}(),]|(?:",At="[{}|(),]))+",St="Jb0tGaduRKEbIbsxFKszAWJEYc0IBs9VRcgRPbUOft4nQs80NZFVNtA3bG==",Nt=Ll("JGgrCqcnGWcxNu8="),Wt="Jb0tGaduRKEdLHYhQqEgAWtwKgcKCsBUQZcXNHAJIcEhVJAIaIZU",Mt=Ll("JqcxHqBuBWEtas4aFHYmUq5pOt0OCbBOCIkSJ1kCJZAsVNk4KcMMNahOe1oOOMkFNZszNhYWAIIMXXZnTcUiAxxREbs+L24EFWZyAYcWSW=="),Lt=Mt+Ll("YbocBbEnHuItJa0aDHQmDuBHLIYPEIgVRcINOGUMMsUhDJAJMccCaZsUNrwVOIwOaNghPJ9QBt4NUMI="),Ot=Lt+Ll("YaAbGHUdDeIdKaMVDHQaDuFzJswKDsgLbwsNOGcCMJslUMk5JdEXPIU0MqkRJZIWIs0rDgcMDIcyWsQiE3YlHcdeBG02FW=="),Dt="0123456789",Rt=ke+ke.toUpperCase()+Dt+Dt,$t=Dt+ke.slice(0,6).toUpperCase(),It="box",zt="exe",Ht="label",Ut="select",Pt="word",qt="advanced",Bt="afMode",jt="afRule",Ft="afTick",Jt="afValue",Kt="afVars",Vt="all",Gt="aria",Yt=Gt+"-checked",Zt=Gt+"-controls",Qt=Gt+"-describedby",_t=Gt+"-"+Ht+"ledby",Xt=Gt+"-"+Ht,en=Gt+"-"+Ut+"ed",tn="audio",nn="auto",rn=nn+"fill",ln=rn+"ing",an=nn+"mation",sn="Backspace",on="Backup - ",cn="backup",un="blur",fn="border",dn="button",hn="captcha",pn="cat",gn=pn+zt,mn=pn+"now",bn=pn+ke[18],yn="challenge",vn="change",wn="check"+It,En="click",Cn="closeinfobar",kn="complete",xn="content",Tn="data",An="delay",Sn="div",Nn="docs",Wn="done",Mn=".com",Ln="editable",On="Escape",Dn="exceptions",Rn="false",$n="fields",In="filter",zn="focus",Hn="font",Un="forcefill",Pn="form",qn="frame",Bn="function",jn="gen",Fn=jn+"eral",Jn="heading",Kn="hidden",Vn=Tn+"-"+rn+"-highlight",Gn="-id=",Yn=ke[8]+qn,Zn=Yn.toUpperCase(),Qn="image",_n="initialClass",Xn="initialValue",er="input",tr="isBusy",nr="isDirty",rr="isInput",ir="isSelectable",lr="jsaction",ar="keydown",sr="keyup",or="list",cr="load",ur="manual",fr="Menu",dr="mousedown",hr="mouseup",pr="ng-model",gr=":not(",mr="observe",br="off",yr="open",vr="option",wr="other",Er="padding",Cr="pass"+Pt,kr="placeholder",xr="prevLen",Tr="Profile",Ar="question",Sr="radio",Nr="re"+hn,Wr="response",Mr="role",Lr="rules",Or="Rule",Dr=Ut.toUpperCase(),Rr=Ut+"ion",$r="",Ir="site",zr="slug",Hr="span",Ur="status",Pr="step",qr="string",Br="strong",jr="style",Fr="sync",Jr="text",Kr=Jr+"clips",Vr="timer",Gr="tooltips",Yr="true",Zr="type",Qr="Unfiled",_r="URL",Xr=fe?oe[_r]:oe.referrer,ei="value",ti="variables",ni="Width",ri=Ll("OWADCqYkPb4aMXQqCG=="),ii="wizard",li=rn+"-"+ii,ai=rn.toUpperCase(),si=En.toUpperCase(),oi="DISPATCH",ci=yr.toUpperCase(),ui="RELOAD",fi="SCRAPE",di=jr.toUpperCase(),hi="WAIT",pi=[Vt,Un],gi=[Gt+"-busy",Yt,Gt+"-current",Gt+"-expanded",Gt+"-invalid",en],mi=["1","0","on",br,Yr,Rn,"yes","no"],bi=[],yi=["email","search","tel",Jr,Jr+"area",_r.toLowerCase()],vi=[],wi=[bn,Lr,qt,Dn,Kr,ti],Ei=[],Ci=[oe.title,oe[_r]],ki=new Map,xi={},Ti={once:!0},Ai=0,Si=!1,Ni=oe.body,Wi="";ce.lang;var Mi,Li,Oi,Di,Ri,$i,Ii,zi,Hi,Ui,Pi,qi,Bi,ji,Fi,Ji,Ki,Vi,Gi,Yi,Zi,Qi,_i=0,Xi=!1,el=!1,tl=!1,nl=new Event(Wn),rl=oe[_r].includes("crowdtap"+Mn),il=Ni?.hasAttribute(lr)&&oe[_r].toLowerCase().includes(Nn+".google"+Mn+"/"+Pn+ke[18]),ll=!il&&new RegExp(Pn+"s\\.(microsoft|office)\\"+Mn+"/pages/"+Wr+"page",ke[8]).test(oe[_r]),al=function(e){return e===wn||e===Sr},sl=function(){return!I&&10-+E.toString(16)<=0},ol=function(e){if(be?.id&&v)if(!he.Wizard||e.key!==On||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey){let t=[{h:a},...u].map((({h:e})=>e||""));for(let n,r,i=0;i<t.length;++i)if(t[i]){r=!0,n=t[i].split(" + ");for(let t=0;t<n.length;++t)switch(n[t]){case"Ctrl":e.ctrlKey||(r=!1);break;case"Shift":e.shiftKey||(r=!1);break;case"Alt":case"Option":e.altKey||(r=!1);break;case"Win":case"⌘":e.metaKey||(r=!1);break;default:n[t].replace("Space"," ").toUpperCase()!==(e.key||"").toUpperCase()&&(r=!1)}if(r)return e.preventDefault(),void aa({type:"eR",data:{catnow:0===i?1:i+4,force:!0}})}}else Wizard.c()};try{o=de.host?de.host.replace(xt,""):de.pathname.replace(/^.+?(\/)(.+\/)?.+$/,"$1$2")}catch(e){}if(il)Ci.push(oe[_r].replace(/\/u\/\d+\//,"/"));else if(ue)try{Ci.push(parent.document.title,parent.document[_r])}catch(e){}class cl{constructor(e){let t=e.ownerDocument||e.document,n=t.defaultView||t.parentWindow;this.cloneStyles=["width","height",fn+"Bottom"+ni,fn+"Left"+ni,fn+"Right"+ni,fn+"Top"+ni,It+"Sizing",Hn+"Family",Hn+"Size",Hn+"Stretch",Hn+"Style",Hn+"Variant",Hn+"Weight","letterSpacing","lineHeight","overflowX","overflowY",Er+"Bottom",Er+"Left",Er+"Right",Er+"Top",Jr+"Align",Jr+"Indent",Jr+"Transform",Pt+"Spacing"],this[rr]=e.nodeName.toLowerCase()===er,this[Rr]=n?.getSelection(),this.isContentEditable=e.isContentEditable&&!!this[Rr]?.rangeCount,this[ir]=void 0!==e.selectionEnd,this.target=e}getPos(){let e=this.target,t=-1;if(this.isContentEditable){let n=this[Rr].getRangeAt(0),r=n.cloneRange();r.selectNodeContents(e),r.setEnd(n.endContainer,n.endOffset),t=r.toString().length;try{let t=n.startContainer,r=n.endContainer,i=[],l=[];for(;t!==e;)i.push(ql(t)),t=t.parentElement;for(;r!==e;)l.push(ql(r)),r=r.parentElement;this.startNodeIndexes=i,this.startOffset=n.startOffset,this.endNodeIndexes=l,this.endOffset=n.endOffset}catch(e){}}else this[ir]&&(t=e.selectionEnd);return t}getXY(){let e=this.target;if(this.isContentEditable){return this[Rr].getRangeAt(0).getBoundingClientRect()}if(this[ir]){let t=e.selectionEnd,n=e.value,r="af-ac-"+i,l=oe.getElementById(r),a=n.substring(0,t),s=getComputedStyle(e),o=parseInt(s[fn+"Top"+ni]),c=parseInt(s[fn+"Left"+ni]),u=function(e){let t=0,n=0;for(;e;)t+=e.offsetTop,n+=e.offsetLeft,e=e.offsetParent;return{top:t,left:n}}(e),f=u.top,d=u.left,h={position:"absolute",top:f+o+"px",left:d+c+"px",overflow:Kn,visibility:Kn,whiteSpace:"pre-wrap"};l||(l=oe.createElement(Sn),l.id=r,Ni.appendChild(l)),this[rr]||(h[Pt+"Wrap"]="break-"+Pt),Object.keys(h).forEach((e=>{l.style[e]=h[e]})),this.cloneStyles.forEach((e=>{l.style[e]=s[e]})),this[rr]&&(a=a.replace(kt," ")),l.textContent=a;let p=oe.createElement(Hr),g={top:Math.round(f-e.scrollTop+p.offsetTop+o-scrollY),left:Math.round(d-e.scrollLeft+p.offsetLeft+c-scrollX)};return p.textContent=n.substring(t)||".",l.appendChild(p),l.remove(),g}}setText(e="",t=0,n=0){let r=this.target;if(this.isContentEditable){let n,i,l=this[Rr],a=l.getRangeAt(0),s=r,o=r;for(n=this.startNodeIndexes,i=n.length;i--;)s=s.childNodes[n[i]];for(n=this.endNodeIndexes,i=n.length;i--;)o=o.childNodes[n[i]];if(typeof e===qr){this[tr]=!0;let n=this.startOffset-t;n<0&&(n=0);try{let t=oe.createRange(),i=oe.createRange(),a=oe.createTextNode(e);i.setStart(s,n),i.setEnd(s,this.startOffset),i.deleteContents(),i.insertNode(a),t.setStart(a,a.length),t.setEnd(a,a.length),l.removeAllRanges(),l.addRange(t),r.normalize(),this.getPos()}catch(e){}this[tr]=!1}else a.setStart(s,this.startOffset),a.setEnd(o,this.endOffset),l.removeAllRanges(),l.addRange(a)}else this[ir]&&r.setRangeText(e,t,n,"end")}}async function ul(e,t,i,a,s){let c=s||(m||v[Lr]);if(0===Object.keys(c).length)return;let u,f,d,b,x,T,A,S=[],W=[],M={},L={},O={},D=0,R=async function(e,t,n){if(!t||void 0===t.type&&t.innerHTML===n)return!1;let r=void 0===t.value?t.innerHTML:t.value;switch(void 0===t[Bt]?x[ke[14]]:t[Bt]){case 2:n+=r;break;case 3:n=r+n;break;case 4:n=n+r+n;break;case 5:n=isNaN(r)?r:++r;break;case 6:n=isNaN(r)?r:--r}if(!C&&10-+E.toString(16)<=0&&!I)return sa(),!1;try{let r=t.getAttribute(Gt+"-"+nn+kn),i=[],l=[],a=!1,s=!1;if(r===or||"both"===r){await Tl(t,[dr]);let e=await function(e,t,n=1e3){return new Promise((r=>{let i=Date.now(),l=()=>{e.hasAttribute(t)?r(e.getAttribute(t)):Date.now()-i>=n?r(null):setTimeout(l,100)};l()}))}(t,Zt);if(e){a=la(await Xl("#"+e),n),s=!0}}return s||(await Tl(t,[ar]),void 0===t.value?(t.innerHTML=n,i.push(zn),l.push(un),a=!0):(t.value=await function(e,t,n=1e3){return new Promise((r=>{let i=Date.now(),l=()=>{e.value===t?r(t):Date.now()-i>=n?r(null):(e.value=t,setTimeout(l,200))};l()}))}(t,n,2e3),t.value&&(a=!0))),a&&(await Tl(t,[...i,er,sr,vn,...l]),_l(e,t),++D),!0}catch(e){return!1}},z=function(e){if(Ql(f))return H()&&e===ta(f);if(e.hasAttribute(_t)&&Zl(f,[zl(e)]))return H();if(e.id&&Zl(f,[$l(e)]))return H();if(il||ll){let t=(il?Il(e,!0):Hl(e,!0)).trim();if(t&&Zl(f,t.split("\n")))return H()}let t=[(e.name||"").trim(),(e.id||"").trim(),(e.placeholder||"").trim(),(e.title||"").trim(),(e.className||"").trim(),(e[_n]||"").trim(),Al(e,Xt),Al(e,Tn+"-bind"),Al(e,Tn+"-reactid"),Al(e,pr),Al(e,_t),Al(e,Qt)];return e.hasAttribute(nn+kn)&&t.push(...Fl(e,nn+kn,!0).split(/ +/)),void 0!==e.value&&al(e.type)&&t.push(Fl(e,ei,!0)),e.src&&e.src.startsWith(location.origin)&&e.src!==oe[_r]&&t.push((e.src||"").trim()),t=pl(t),Zl(f,t)||e.parentElement?.nodeName===Ht.toUpperCase()&&Zl(f,[e.parentElement?.textContent.trim()])?H():H()&&e===ea(f)},H=function(){return I||10-+E.toString(16)>0||C>0},U=function(e,t,n){if(y.vars){let r,i,l,a=t;if(t=Jl(t),(l=ze).test(t)){let e,n,i;r=t.match(l);for(let a=0;a<r.length;++a)l=new RegExp(r[a]),e=r[a].replace(_e,""),n=r[a].slice(1,2),v[Lr][ke[17]+e]&&void 0!==v[Lr][ke[17]+e][n]&&(i=n===ke[21]&&O[ke[17]+e]?O[ke[17]+e]:v[Lr][ke[17]+e][n],t=t.replace(l,i))}if(n)return t;if((l=Fe).test(t)){r=t.match(l);for(let e,n,i=0;i<r.length;++i)l=new RegExp(r[i].replace(je,"($1)}").replace(nt,"\\+")),e=+r[i].replace(Pe,"$1"),n=r[i].indexOf("++")>0?1:r[i].indexOf("--")>0?-1:+r[i].replace(Be,"$1"),t=t.replace(l,e+n),a=a.replace(l,"{``"+(e+n)+"``$1}");x[ke[21]]=a.replace(qe,"$1"),S.push({key:e,obj:x})}if((l=rt).test(t)){let e,n;r=t.match(l);for(let i=0;i<r.length;++i){switch(l=new RegExp(r[i].replace("$","\\$")),e=+r[i].replace(_e,"")||1,r[i][1]){case"#":n=ra(1,9);for(let t=1;t<e;++t)n+=ra(0,9)+"";break;case"$":n=Rt[ra(0,51)];for(let t=1;t<e;++t)n+=Rt[ra(0,71)];break;case ke[0]:n="";for(let t=0;t<e;++t)n+=Rt[ra(0,25)];break;case"A":n="";for(let t=0;t<e;++t)n+=Rt[ra(26,51)];break;case"%":n="";for(let t=0;t<e;++t)n+=$t[ra(0,15)]}t=t.replace(l,n)}}if((l=tt).test(t)){let e;r=t.match(l),r[2]>r[1]&&(e=ra(+r[1],+r[2]),t=t.replace(l,e))}let s="(?:(?:[^|\\\\"+Tt+"\\\\"+At+"(?:\\|(?:[^|\\\\"+Tt+"\\\\"+At+")+)";if((l=new RegExp("\\{"+s+"\\}",ke[6])).test(t)){r=t.match(l);for(let e=0;e<r.length;++e)l=new RegExp(Cl(r[e])),i=r[e].substring(1,r[e].length-1).split(/(?<!\\)\|/),t=t.replace(l,i[ra(0,i.length-1)].replace(Ke,""))}if((l=new RegExp("\\{\\("+s.replace("+)+","+)*")+"\\)\\}",ke[6])).test(t)){r=t.match(l);for(let e,n=0;n<r.length;++n)l=new RegExp(Cl(r[n])),i=r[n].substring(2,r[n].length-2).split(/(?<!\\)\|/),e=ra(0,i.length-1),t=t.replace(l,i[e].replace(Ke,"")),i.splice(e,1),a=a.replace(l,"{``("+i.join("|")+")``}");x[ke[21]]=a.replace(bt,"$1").replace(yt,""),S.push({key:e,obj:x})}let o="(?:(?:[^|\\\\"+Tt+"\\\\"+At+"(?:,(?:[^|\\\\"+Tt+"\\\\"+At+")+)";if((l=new RegExp("\\{"+o+"\\}",ke[6])).test(t)){r=t.match(l);for(let e,n=0;n<r.length;++n)l=new RegExp(Cl(r[n])),e=r[n].substring(1,r[n].length-1),i=e.split(/(?<!\\),/),Object.hasOwn(x,e)||(x[e]=0),t=t.replace(l,i[x[e]].replace(Ke,"")),void 0===i[++x[e]]&&(x[e]=0);S.push({key:e,obj:x})}if((l=new RegExp("\\{\\("+o.replace("+)+","+)*")+"\\)\\}",ke[6])).test(t)){r=t.match(l);for(let e=0;e<r.length;++e)l=new RegExp(Cl(r[e])),i=r[e].substring(2,r[e].length-2).split(/(?<!\\),/),t=t.replace(l,i[0].replace(Ke,"")),i.shift(),a=a.replace(l,"{``("+i.join(",")+")``}");x[ke[21]]=a.replace(bt,"$1").replace(yt,""),S.push({key:e,obj:x})}}return H()?t:""},P=function(){let e=this.nodeName===Zn?this.contentDocument.body:this;if(this[Bt]||!gl(e.innerHTML)){if(!R(this[jt],e,this[Jt]))return;i||(oe[rn+"ed"]=performance.now())}};if(!t?.length){t=na(Ot);for(let e=0;e<vi.length;++e)t.indexOf(vi[e])<0&&t.push(vi[e])}if(T=t.length,T&&y["attributes"+br]){let e=v["attributes"+br].split(/ *,? */);for(let n=0;n<T;++n)for(let r=0;r<e.length;++r)t[n].removeAttribute(e[r])}C=s?c.x:0,h={},oe[ln]=performance.now();for(const t in c){let n=!1;i?g[c[t].c]&&g[c[t].c].n===on+o&&(n=!0):void 0===e||e===Vt?(""===c[t].c||g[c[t].c]&&g[c[t].c].n.indexOf(on)<0)&&(n=!0):(c[t].c===e||p[c[t].c]&&p[c[t].c][Vt]||p[t]&&p[t][Vt])&&(n=!0),n&&(L[t]=c[t])}if(0!==Object.keys(L).length){for(const e in L)if(x=L[e],s||!(p[x[ke[2]]]&&p[x[ke[2]]][An]||p[e]&&p[e][An])){f=U(e,ua(x[ke[13]]),!0),d=x[ke[21]];for(let i,l=0;l<T;++l)if(A=t[l],!(A.disabled||A.readOnly||A.id==="g-"+Nr+"-"+Wr||A.type===Kn&&(il||ll))){switch(u=A.type,i=al(u),x[ke[19]]){case 0:if(u===Cr||i||A.nodeName===Dr)continue;break;case 1:if(u!==Cr)continue;break;case 2:if(A.nodeName!==Dr&&A.role!==or+It&&A.getAttribute(Gt+"-haspopup")!==or+It)continue;break;case 3:if(u!==wn&&u!==Sr&&!A.hasAttribute(Yt))continue}switch(x[ke[19]]){case 0:case 1:if(A.nodeName===er.toUpperCase()||"TEXTAREA"===A.nodeName){if($&&Yl(A))continue;if((x[ke[14]]||!A.value)&&z(A)){if(!R(e,A,U(e,d)))return;y.vars&&d.indexOf("{")>-1&&(O[e]=A.value)}}else{let t,n=A.nodeName===Zn;if(A.srcdoc&&(t=Rl(A)),Array.isArray(t)){for(const n of t)if((!$||!Yl(n))&&(x[ke[14]]||!n.value)&&z(n)){if(!R(e,n,U(e,d)))return;y.vars&&d.indexOf("{")>-1&&(O[e]=n.value)}}else if(!n&&!A.isContentEditable||n&&!ga(A)||!z(A))continue;if(void 0===A[Wn]){if(void 0!==A[Bt])continue;A[Bt]=x[ke[14]],A[jt]=e,A[Jt]=U(e,d),A.addEventListener(Wn,P,Ti)}else{let t=n?A.contentDocument.body:A;if((x[ke[14]]||!gl(t.innerHTML))&&!R(e,t,U(e,d)))return}}break;case 2:if(z(A)){let t=!I&&10-+E.toString(16)<=0;if(A.nodeName===Dr){let n=function(){if(t&&!C)return sa(),!1;let n=A.id&&A.nextElementSibling;return n&&n.id===A.id+"-"+dn&&n.children[1]&&n.children[1].className==="ui-"+Ut+"menu-"+Jr&&(n.children[1].textContent=A[A.selectedIndex].text||""),_l(e,A),++D,!0};if(d=U(e,d).trim().toLowerCase(),"?"===d){if(A.selectedIndex=ra(0,A.options.length-1),await Tl(A,[vn]),!n())return}else if(vt.test(d)){for(let e=0;e<A.length;++e)switch("!"===d||"1!"===d){case!0:A[e].selected||(A[e].selected=!0);break;case!1:A[e].selected&&(A[e].selected=!1)}if(await Tl(A,[vn]),!n())return}else if(isNaN(d)){if(A.multiple){ft.test(d)||(d=d.replace(ht,"|")),dt.test(d)||(d=d.replace(ht,""));let e=ut.test(d)?d.split("|"):d.match(ct),t=!1;null===e&&(e=['"'+d+'"']);for(let n,r,i=0;i<A.length;++i)n='"'+A[i].value.toLowerCase().replace(Le,'\\"')+'"',r='"'+(A[i].text||"").toLowerCase().replace(Le,'\\"')+'"',A[i].selected?e.indexOf(i+"")<0&&e.indexOf(n)<0&&e.indexOf(r)<0&&(A[i].selected=!1,t=!0):(e.indexOf(i+"")>-1||e.indexOf(n)>-1||e.indexOf(r)>-1)&&(A[i].selected=!0,t=!0);if(await Tl(A,[vn]),t&&!n())return}else if(d=d.replace(De,""),d=d.replace(Oe,'"'),A.value.toLowerCase()!==d)for(let e=0;e<A.length;++e)if(d===A[e].value.toLowerCase()||d===(A[e].text||"").toLowerCase()){if(A[e].selected=!0,await Tl(A,[vn]),!n())return;break}}else if(A.selectedIndex!=d&&(A.selectedIndex=+d,await Tl(A,[vn]),A.selectedIndex==d&&!n()))return}else if(il||ll){if(!C&&t)return void sa();let i,l,a=r/n;A[jt]=e,A[Jt]=d,A[Ft]=0,il?(i=function(e){if(Si){if(++e[Ft]===a)return;setTimeout((()=>i(e)),n)}else{let t=e.querySelector(Sn+"["+en+"]");if(t)Si=!0,t.click(),e[Ft]=0,l(e);else{if(++e[Ft]===a)return;setTimeout((()=>i(e)),n)}}},l=function(e){let t=e.querySelector(Sn+"["+lr+"]>"+Sn+"["+Tn+"-"+ei+'="'+kl(e[Jt])+'"]');if(t)t.click(),Si=!1,_l(e[jt],e);else{if(++e[Ft]===a)return;setTimeout((()=>l(e)),n)}}):(i=function(e){if(Si){if(++e[Ft]===a)return;setTimeout((()=>i(e)),n/10)}else Si=!0,setTimeout((()=>{e.click(),e[Ft]=0,l(e)}),n/10)},l=function(e){let t=Ni.lastElementChild,r=t.nodeName===Sn.toUpperCase()?t.querySelector("["+en+"] ["+Xt+'="'+kl(e[Jt])+'"]'):null;if(r)r.click(),Si=!1,_l(e[jt],e);else{if(++e[Ft]===a)return;setTimeout((()=>l(e)),n/10)}}),i(A)}}break;case 3:if(z(A)){let t;if(d=U(e,d),b=d.replace(kt,""),"?"===b)switch(A.type){case wn:if(t=fa(A,ra(0,1),e),t<0)return;D+=t;break;case Sr:if(f=f.replace(Ve,""),!W.includes("["+f+"]")){let n=na(er+"["+Zr+"="+Sr+"]"+(f?'[name="'+kl(f)+'"]':""));if(t=fa(n[ra(0,n.length-1)],1,e),t<0)return;W.push("["+f+"]"),D+=t}}else if(!il&&!ll&&A.type&&b.length>1&&!b.includes("!")){if(void 0===M[f]?M[f]=0:++M[f],M[f]<b.length&&(t=fa(A,+b.charAt(M[f]),e),t<0))return;b.length===M[f]+1&&++D}else{let n=10-+E.toString(16)<=0&&!I;if(il||ll){if(n&&!C)return void sa();d===(A.getAttribute(Xt)||A.value||"").trim()&&A.getAttribute(Yt)!==Yr&&(A.click(),_l(e,A),++D)}else{if(t=fa(A,parseInt(b),e),t<0)return;D+=t}}}}}if(!i&&!frameElement)if(4===x[ke[19]])if(k<2)fe&&sa(10-+E.toString(16)>0||C>0);else{let t=10-+E.toString(16)<=0&&!I;if(oe.readyState===kn){if(!C&&t)return void sa();D+=xl(e,d)}else he.onload=function(e,n){return function(){!t||C?D+=xl(e,n):sa()}}(e,d)}else if(x[ke[19]]>4&&!h[e]){d=U(e,d);let t,n,r=pl(d.split(/\s+/));switch(x[ke[19]]){case 5:r[0][0]===ke[2]&&H()&&(ul(r[0]),_l(e,ai+" "+r[0]),++D);break;case 6:f&&H()&&(n=Ql(f)?ta(f):ea(f),n&&(n.click(),_l(e,si+" "+f),++D));break;case 7:f&&r.length&&H()&&(n=Ql(f)?ta(f):ea(f),n&&(await Tl(n,r),_l(e,oi+" "+f+" "+d),++D));break;case 8:if(fe&&r[0]&&H()){let t=r[1]?ml(r[1]):"";r.length>1?open(r[0],t):location=r[0],_l(e,ci+" "+r[0]+(t?" "+t:"")),++D}break;case 9:if(t=Math.max(+d||0,0),fe&&f&&t>=1&&H()){let r=setTimeout((e=>{n=Ql(e)?ta(e):ea(e),n?clearTimeout(r):location.reload()}),1e3*t,f);_l(e,ui+" "+f+" "+t),++D}break;case 10:if(f&&d&&H()){let t=((Ql(f)?ta(f)?.textContent||ta(f)?.value:ea(f)?.textContent||ea(f)?.value)||"").trim();if(t){let n=ml(d);l["af_"+n]=t,_l(e,`${fi} ${f} ${n} = ${t}`),++D}}break;case 11:if(d&&H()){let t=d.replace(et," ").replace(pt," "),n=oe.createElement(jr);n.textContent=t,oe.head.appendChild(n),_l(e,di+" "+t),++D}break;case 12:(f||d)&&H()&&(t=Math.max(+d||0,0),f?t?await Xl(f,1e3*t):await Xl(f):await El(1e3*t),_l(e,hi+(f?" "+f:"")+(d?" "+t:"")),++D)}h[e]=1}await El()}if(!i){if(!s){let t;for(const n in L)if(t=p[n]&&p[n][An]||p[L[n].c]&&p[L[n].c][An]||0,t){let r={};r[n]=L[n],r[ke[23]]=Math.max(10-+E.toString(16),0),setTimeout((e=>{ul(e[gn],[],!1,!1,e[An])}),1e3*t,{catexe:e,delay:r})}}S.length&&ca(Lr,(e=>{let t=JSON.parse(e[Lr]);for(let e=0;e<S.length;++e)t[S[e].key]=S[e].obj;var n,r;n={rules:JSON.stringify(t)},new Promise(((e,t)=>{let i=[],l={},a={};for(const e in n)wi.includes(e)?l[e]=n[e]:a[e]=n[e];Object.keys(l).length&&i.push(Ce.local.set(l)),Object.keys(a).length&&i.push(Ce.sync.set(a)),Promise.all(i).then((()=>{typeof r===Bn&&r(),e()})).catch(t)})).catch((e=>{throw e}))})),pa(T),oe[rn+"ed"]=performance.now(),delete oe[ln]}return Li||(Oi||(Di||(Ri||($i||(Ii||(zi||(E||(w||(k||(N||(I||(Hi||(Ui||(Pi||(qi||(Bi||(ji||(Fi||(Ji||(Ki||(Vi||(Gi||(Yi||(Zi||(Qi||void 0)))))))))))))))))))))))))}}function fl(e){if(!H)return[];let t,n;if(Ul(),il?t=Il(H):ll&&(t=Hl(H)),t||(t=Pl(H)),!n)if(void 0!==H.type)n=H.value;else if(H.isContentEditable)n=Dl(H.innerHTML);else if(H.nodeName===Zn&&(n=Rl(H),typeof n!==qr))return[];return t&&n!==H[Xn]?[{t:H.type===Cr?1:0,n:t,v:n,s:$r,c:e}]:[]}function dl(e,t){let n,r,i,l=gr+"[disabled])"+gr+"["+Kn+"])"+gr+"[readonly])",a=Sn+"["+lr+"][",s=Sn+"["+Tn+"-"+an+Gn+Ar+"Item] "+Sn+"[",c=[],u=na(Mt+l,t),f=na(Ut+l,t),d=na(Jr+"area"+l,t),h=na("["+xn+Ln+"="+Yr+"]"+gr+"html)"+gr+"body)",t),p=na(Yn,t),g=il?na(a+Yt+"="+Yr+"]",t):[],m=il?na(a+en+"="+Yr+"]",t):[],b=ll?na(s+Yt+"="+Yr+"]",t):[],v=ll?na(s+Gt+"-haspopup] ["+Xt+"]",t):[];Ul();for(let t,l,a=0;a<u.length;++a)if(t=u[a],r="",n=t.type,i=t.value,l=al(n),("file"!==n||i)&&n!==Kn&&!t.parentElement?.id.startsWith(rn+"-")&&(n!==Cr&&n!==wn&&n!==Sr&&(n=Jr),!(!i&&!t[Xn]||(n===Jr||n===Cr)&&i===t[Xn]||l&&t.checked===t[Xn])))switch(il?r=Il(t):ll&&(r=Hl(t)),r||(r=Pl(t)),n){case Jr:r&&c.push({t:0,n:r,v:i,s:$r,c:e});break;case Cr:c.push({t:1,n:r,v:i,s:$r,c:e});break;default:l&&c.push({t:3,n:r,v:ll?t.getAttribute(Xt)||i:Nl(t)||+t.checked+"",s:$r,c:e})}for(let t,n=0;n<f.length;++n)if(t=f[n],i=t.multiple?Bl(t):t.value,(i||t[Xn])&&i!==t[Xn]&&!t.parentElement?.id.startsWith(rn+"-")&&(r=Pl(t),r)){if(t.multiple){i="";for(let e=0,n=t.length,r=0;e<n;++e)t[e].selected&&(i+='|"'+(t[e].value||t[e].text||"").replace(Le,'\\"')+'"',++r),e===n-1&&r===n&&(i="1!");i=i.slice(1)}else i='"'+(t.value||t.text||"").replace(Le,'\\"')+'"';c.push({t:2,n:r,v:i,s:$r,c:e})}for(let t,n=0;n<d.length;++n)t=d[n],r="",i=t.value,!i&&!t[Xn]||i===t[Xn]||Yl(t)||(il?r=Il(t):ll&&(r=Hl(t)),r||(r=Pl(t)),r&&c.push({t:0,n:r,v:i,s:$r,c:e}));for(let t,n=0;n<h.length;++n)t=h[n],i=Dl(t.innerHTML),(i||t[Xn])&&i!==t[Xn]&&(r=Pl(t),r&&c.push({t:0,n:r,v:i,s:$r,c:e}));for(let t,n=0;n<p.length;++n)if(t=p[n],i=Rl(t),Array.isArray(i)){let n=dl(e,t.contentDocument);n.length&&(c=c.concat(n))}else{if(void 0===i||!i&&!t[Xn]||i===t[Xn])continue;if(r=Pl(t),r){if(y[Ir+In+ke[18]]&&self!==top&&top.origin.indexOf(o)>-1){let e=Ml($r,top.location.host.replace(xt,"")+top.location.pathname);e&&($r=e)}c.push({t:0,n:r,v:i,s:$r,c:e})}}for(let t,n=0;n<g.length;++n)t=g[n],r=Il(t),r||(r=Pl(t)),i=(t.getAttribute(Xt)||"").trim(),i&&r&&c.push({t:3,n:r,v:i,s:$r,c:e});for(let t,n=0;n<m.length;++n)t=m[n],r=Il(t),r||(r=Pl(t)),i=(t.getAttribute(Tn+"-"+ei)||"").trim(),i&&r&&c.push({t:2,n:r,v:i,s:$r,c:e});for(let t,n=0;n<b.length;++n)t=b[n],r=Hl(t),r||(r=Pl(t)),i=(t.getAttribute(Xt)||t.value||"").trim(),i&&r&&c.push({t:3,n:r,v:i,s:$r,c:e});for(let t,n=0;n<v.length;++n)t=v[n],r=Hl(t),r||(r=Pl(t)),i=(t.getAttribute(Xt)||"").trim(),i&&r&&c.push({t:2,n:r,v:i,s:$r,c:e});return c}function hl(e){if(!be?.id||!y[cn]||!e.inputType)return;if(!(H=e.target.matches(Lt)?e.target:e.target.ownerDocument.defaultView.frameElement))return;let t=H.contentDocument;if((t&&t.body?Dl(t.body.innerHTML):H.value||Dl(H.innerHTML)).length<v[cn])return;let n,r=on+o,i=!0;for(let e=0;e<f;++e)if(u[e].n===r){n=u[e].k,i=!1;break}i?aa({type:"sC",data:{backup:!0,cat:{n:r,s:$r}}},(e=>{e?.cat&&ia(e.cat)})):ia(n)}function pl(e){return e.filter(((t,n)=>null!=t&&""!==t&&e.indexOf(t)===n))}function gl(e){return e.replace(Ue,"")}function ml(e){return e.replace(Xe,"_")}function bl(){U&&(U.initialStyle?U.setAttribute(jr,U.initialStyle):U.removeAttribute(jr),delete U.initialStyle)}function yl(e){e.observer||(e.observer=new MutationObserver((e=>{let t=T?s:void 0;e.forEach((e=>{let n,r=[];for(let t=0;t<e.addedNodes.length;++t)if(n=e.addedNodes[t],1===n.nodeType&&n.id!==li&&!gt.test(n.nodeName)&&(n.nodeName!==Zn||ga(n)))if(n.children&&n.children.length){let e=na(Ot,n);for(let t=0;t<e.length;++t)(void 0!==e[t][Xn]||vi.indexOf(e[t])>-1)&&e.splice(t,1);r.push(...e)}else n.matches(Ot)&&vi.indexOf(n)<0&&r.push(n);if(r.length){if(1===r.length&&r[0].type===Kn)return;if(pa(r.length),Vl(r),vi=vi.concat(r),ul(t,r,!0),oe[ln]&&!O){let e=Ol(),n=(new Date-x)/1e3;n>e?e=0:e-=n,e?setTimeout((e=>{ul(e[gn],e[$n],e[cn],e[mr])}),1e3*e,{catexe:t,fields:r,backup:!1,observe:!0}):ul(t,r,!1)}}}))})),e.observer.observe(e.body||e,{childList:!0,subtree:!0}))}function vl(e){let t;return function(){let n=this,r=arguments;clearTimeout(t),t=setTimeout((function(){e.apply(n,r)}),50)}}function wl(e,t){if(!W)return;let n="[43m[30m["+we+"] "+e;t?console.info(n,"\n",t):console.info(n)}async function El(e=0){return new Promise((t=>setTimeout(t,e)))}function Cl(e){return e.replace(at,"\\$1")}function kl(e){return e.replace($e,"\\$&").replace(Je," ")}function xl(e,t){if(k<2)return 0;let n=0;try{postMessage(Nt+e),_l(e,t),++n}catch(e){}return n}async function Tl(e,t){return new Promise((async n=>{if(!e)return void n();let r={bubbles:!e.classList.contains("wym_"+Yn)};for(let n,i=0;i<t.length;++i){switch(n=null,t[i]){case un:e.blur();break;case En:e.click();break;case zn:e.focus({preventScroll:!0});break;case er:n=new InputEvent(t[i],r);break;case ar:case sr:n=new KeyboardEvent(t[i],r);break;case dr:case hr:n=new MouseEvent(t[i],r);break;default:try{n=new Event(t[i],r)}catch(e){}}!n||t[i]===vn&&e.value===e[Xn]||e.dispatchEvent(n),z||await El()}n()}))}function Al(e,t){return(e.getAttribute(t)||"").trim()}function Sl(e){return e>2?u[e-5].k:1===e?Vt:""}function Nl(e){if(!e.name)return"";let t=oe.getElementsByName(e.name),n="";for(let e=0;e<t.length;++e)n+=+t[e].checked+"";return n}function Wl(e,t,n=0,r){if(t&&typeof t===qr){let i=0;for(;e=e.parentElement;){if(++i>=n&&e.matches(t))return e;if(i>=r)break}return null}return e.parentElement}function Ml(e,t){for(;-1===e.indexOf(t)||"/"!==t.slice(-1);)t=t.slice(0,-1);return t}function Ll(e){return function(e,t){let n="";for(let t,r=0;r<e.length;++r)t=e[r],n+=r%2==0?t:t===t.toLowerCase()?t.toUpperCase():t.toLowerCase();let r=Uint8Array.from(atob(n),(e=>e.charCodeAt(0))),i=(new TextEncoder).encode(t),l=new Uint8Array(r.length);for(let e=0;e<r.length;++e)l[e]=r[e]^i[e%i.length];return(new TextDecoder).decode(l)}(e,we.replace(Ie,"")+":"+ve)}function Ol(){let e=Math.max(y[An]?v[An]:0,0);return(il||ll)&&e<.5&&(e=.5,y["rand"+An]&&(e+=.25)),e&&y["rand"+An]&&(e+=ra(-250,250)/1e3),e}function Dl(e){return gl(e=e.replace(ot,""))?e.trim():""}function Rl(e){if(ga(e))try{let t=e.contentDocument,n=t&&t.body&&na(Lt,t.body);return n&&n.length?n:t&&t.body?Dl(t.body.innerHTML):void yl(t)}catch(e){return}}function $l(e,t){if(!e.id||t&&!D)return"";let n=ea(Ht+'[for="'+kl(e.id)+'"]');return n?.textContent.trim()||""}function Il(e,t){let n,r,i="",l="",a="";if(!t&&D||(n=Wl(e,Sn+"["+Mr+"="+or+It+"]",2)),(t||D)&&(r=Wl(e,Sn+"["+Mr+"="+or+"item]",4)),n&&(l=Fl(n,Xt)||Fl(n,_t)||Fl(n,Qt),i+=l+"\n"),r)if(e.type===Jr&&e.role==="combo"+It)l=Fl(e,Xt),i+=l+"\n";else{let e=r.querySelector("["+Mr+"="+Jn+"]");e&&(l=e.textContent.trim(),i+=l+"\n")}return!l||t||D&&!ha(d,l)||(a='"'+l+'"'),t?i:a}function zl(e,t){if(t&&!D)return"";let n=e.getAttribute(_t),r=n?oe.getElementById(n):null;return r?r.textContent.trim():""}function Hl(e,t){let n,r,i="",l="",a="";if(!t&&D||e.nodeName===er.toUpperCase()||(n=Wl(e,Sn+"["+_t+"]")),(t||D)&&(r=Wl(e,Sn+"["+Tn+"-"+an+Gn+Ar+"Item]")),n&&(l=Fl(n,_t)||Fl(n,Qt),i+=l+"\n"),r){if(!!!r.querySelector("["+Tn+"-"+an+Gn+"likerTableTr]")){let e=r.querySelector("["+Mr+"="+Jn+"] ."+Jr+"-"+Pn+"at-"+xn);e&&(l=e.textContent.trim(),i+=l+"\n")}}return!l||t||D&&!ha(d,l)||(a='"'+l+'"'),t?i:a}function Ul(){if(!il&&!ll)return;let e="["+Mr+"="+Jn+"]",t=il?Sn+"["+Mr+"="+or+"item] "+e:ll?"#"+Ar+"-"+or+">["+Tn+"-"+an+"-id] "+e+" ."+Jr+"-"+Pn+"at-"+xn:"";t&&(d=[],oe.querySelectorAll(t).forEach((e=>{d.push(e.textContent.trim())})))}function Pl(e){let t=al(e.type),n='"'+((t&&Nl(e)?e.name:"")||zl(e,!0)||$l(e,!0)||e.name||(rl?"":e.id)||Fl(e,Xt)||Fl(e,nn+kn)||Fl(e,kr)||Fl(e,"title")||Fl(e,Tn+"-bind")||Fl(e,Tn+"-reactid")||Fl(e,pr)||Fl(e,_t)||Fl(e,Qt)||(void 0!==e.value&&t?Fl(e,ei):"")||(e.src&&e.src.startsWith(location.origin)&&e.src!==oe[_r]?e.src:"")||"").trim()+'"',r=[];if('""'===n){n=(e[_n]||e.className||"").trim();try{r=oe.querySelectorAll(function(e){let t=e.replace(Je," ").trim().replace(ht,".").replace(Se,"\\$1").replace(He,"$1\\.$2");return t?"."+t:null}(n))}catch(e){}n=n&&1===r?.length?"/\\b"+n+"\\b/":function(e){let t=new Map;function n(n){if(t.has(n))return t.get(n);try{let r=oe.querySelectorAll(n),i=1===r.length&&r[0]===e;return t.set(n,i),i}catch{return!1}}function r(e,t="",r=!1){for(const r of e){let e=`${t}${r.selector}`;if(n(e))return e}let l=e.length;for(let r=0;r<l-1;++r)for(let i=r+1;i<l;++i){let l=`${t}${e[r].selector}${e[i].selector}`;if(n(l))return l}for(let r=0;r<l-2;++r)for(let i=r+1;i<l-1;++i)for(let a=i+1;a<l;++a){let l=`${t}${e[r].selector}${e[i].selector}${e[a].selector}`;if(n(l))return l}if(r){for(const r of e){let e=`${t}${i}${r.selector}`;if(n(e))return e}for(let r=0;r<l-1;++r)for(let a=r+1;a<l;++a){let l=`${t}${i}${e[r].selector}${e[a].selector}`;if(n(l))return l}for(let r=0;r<l-2;++r)for(let a=r+1;a<l-1;++a)for(let s=a+1;s<l;++s){let l=`${t}${i}${e[r].selector}${e[a].selector}${e[s].selector}`;if(n(l))return l}}return null}if(e.id&&!rl)return`#${e.id}`;let i=e.tagName.toLowerCase(),l=Array.from(e.attributes).filter((e=>{let t=e.name;return t===nn+kn||"jscontroller"===t||"jsname"===t||"name"===t||t===pr||t===kr||t===Mr||"title"===t||t===Zr||t===ei||t.startsWith(Gt+"-")&&t.length>5&&!gi.includes(t)||t.startsWith(Tn+"-")&&t.length>5})).map((e=>({name:e.name,value:e.value,selector:`[${e.name}="${kl(e.value)}"]`}))),a=r(l)||r(l,"",!0);if(a)return a;let s=e.parentElement,o=0;for(;s&&o<10;){let e=s.tagName.toLowerCase();if(s.id){let e=r(l,`#${s.id} > `,!0);if(e)return e}let t=r(l,`${e} > `,!0);if(t)return t;s=s.parentElement,++o}return function(e){if(!e)return"";let t=[];for(;e&&e.nodeType===Node.ELEMENT_NODE;e=e.parentNode){let n=0,r=!1;for(let t=e.previousSibling;t;t=t.previousSibling)t.nodeType!==Node.DOCUMENT_TYPE_NODE&&t.nodeName===e.nodeName&&(++n,r=!0);let i=e.nodeName.toLowerCase(),l=r?`[${n+1}]`:"";t.unshift(i+l)}return"/"+t.join("/")}(e)}(e)}return n}function ql(e){return Array.prototype.indexOf.call(e.parentNode.childNodes,e)}function Bl(e){let t=[],n=e.selectedOptions||[];for(let e=0;e<n.length;++e)t.push(n[e].value||n[e].text||"");return JSON.stringify(t)}function jl(e){return(e?.textContent||"").trim()}function Fl(e,t,n){let r,i=(e.getAttribute(t)||"").trim();switch(t){case nn+kn:mi.includes(i)&&(i="");break;case ei:mi.includes(e.value.toLowerCase())&&(i="")}if(i){let e="["+t+'="'+kl(i)+'"]';r=oe.querySelectorAll(e).length;try{self!==top&&top.origin.includes(o)&&(r+=top.document.querySelectorAll(e).length)}catch(e){}}return n||1===r?i:""}function Jl(e=""){if(e){let t,n;if(v[ti].length&&(n=Ct).test(e)){t=e.match(n);for(let r=0;r<t.length;++r)for(let i,l,a=0;a<v[ti].length;++a)if("#"!==v[ti][a][0]&&(i=v[ti][a].match(wt),i&&(i=i.slice(1),t[r]==="{@"+i[0]+"}"))){n=new RegExp("{@"+i[0]+"}",ke[6]),l="",l=i[1].startsWith(Nt)&&k>1?xi[i[0]]||"":i[1].replace(Re,"=").replace(Ze,"\n"),e=e.replace(n,l);break}}if((n=Et).test(e)){t=e.match(n);for(let r=0;r<t.length;++r)n=new RegExp(t[r],ke[6]),e=e.replace(n,l["af"+t[r].replace(Ne,"")]||"")}}return e}function Kl(e){return new Promise(((e,n)=>{ca((r=>{u=(v=r)[bn],f=u.length,y=v[wr],a=v[Vt+"hotkey"]||"",s=Sl(v[mn]),c=v.spreadsheetid||"",T=!!y.activecat,A=!!y[nn+kn]&&v[Kr].length>0,S=!!y[hn+ke[18]],W=!!y.debug,M=!1,D=!!y["parse"+Ht+ke[18]],R=!!y.reveal,$=!!y["skip"+Kn],z=!!y.turbo,b=v[ke[14]],Li=b[ke[0]],Oi=b[ke[1]],Di=b[ke[2]],Ri=b[ke[3]],$i=b[ke[4]],Ii=b[ke[5]],zi=b[ke[6]],E=b[ke[7]],w=b[ke[8]],k=b[ke[9]],N=!!b[ke[10]],I=!!b[ke[11]],Hi=b[ke[12]],Ui=b[ke[13]],Pi=b[ke[14]],qi=b[ke[15]],Bi=b[ke[16]],ji=b[ke[17]],Fi=b[ke[18]],Ji=b[ke[19]],Ki=b[ke[20]],Vi=b[ke[21]],Gi=b[ke[22]],Yi=b[ke[23]],Zi=b[ke[24]],Qi=b[ke[25]],Z="#"+(Mi=(k!==+S+ +I||"")+"")+Nr+"-"+tn+"-"+dn,Q=".rc-"+tn+Mi+yn+"-error-message",_="#"+tn+"-"+Wr+Mi,X="#"+Mi+tn+"-source",ee="#"+Nr+"-accessible-"+Mi+Ur,te=".rc-dos"+hn+"-body"+Mi,ne="."+Nr+"-"+wn+Mi+"-"+fn,re="#"+Mi+"rc-"+Qn+Ut,ie="#"+Nr+Mi+"-re"+cr+"-"+dn,le=".rc-"+tn+yn+"-"+Mi+Wr+"-field",ae="#"+Nr+"-verify-"+Mi+dn;for(let e=0;e<r[Dn].length;++e)if(Zl(r[Dn][e],Ci))return oe.onkeydown=null,M=!0,bi.push(fe?"this page":qn+" "+oe[_r],r[Dn][e]),void n(Ee.getMessage("debugExceptions",bi));let l=JSON.parse(v[Lr]);if(y[Ir+In+ke[18]]){let e=de.host?o+de.pathname:de.pathname.replace(Me,"/");switch(v[Ir+In+ke[18]]){case 0:$r=e;break;case 1:$r=e+de.search;break;case 2:$r=e+de.search+de.hash;break;case 3:$r=de.host?o:e.replace(We,"$1")}}else $r="";g={};for(let e=0;e<f;++e)g[u[e].k]={n:u[e].n,s:u[e].s};p={};for(let e,t,n=0;n<v[qt].length;++n)if(e=v[qt][n].split(":"),e[0]=e[0].trim().toLowerCase(),2===e.length&&(g[e[0]]||l[e[0]])){p[e[0]]||(p[e[0]]={}),t=e[1].trim().split(/ +/);for(let n,r,i,l=0;l<t.length;++l)if(!(t[l].indexOf("=")<1))if(n=t[l].split("="),r=n[0].toLowerCase(),i=n[1].toLowerCase(),r===An){if(i=+i,isNaN(i)||i<=0)continue;p[e[0]][r]=i}else pi.includes(r)&&(p[e[0]][r]=i===Yr)}v[Lr]={};for(const e in l){let t=Jl(l[e].s||g[l[e].c]?.s);t=ua(t),t&&!Zl(t,Ci)||(v[Lr][e]=l[e],y[ur]&&(p[e]&&p[e][Un]||p[v[Lr][e].c]&&p[v[Lr][e].c][Un])&&(m||(m={}),m[e]=l[e]))}l=void 0,y[ur]||(m=void 0),O=!(!y[ur]||p[s]&&p[s][Un]||m),fe&&!he.Wizard&&(he.Wizard=function(){q=oe.createElement(Sn);let e,n=" ("+Ee.getMessage(vr+ke[18]+Tr+ke[18]+fr+"Active")+")",r=Gt+"-expanded",i=Ee.getMessage(dn+"sGenerate"+Or+ke[18]),l=Ee.getMessage(dn+"sGenerate"+Or+"sTT"),a=Ee.getMessage(Fn+"Collapse"),s=Ee.getMessage(Fn+"Expand"),o=[{k:Vt,n:Ee.getMessage(vr+ke[18]+Tr+ke[18]+fr+"All")},{k:"",n:Ee.getMessage(vr+ke[18]+Tr+ke[18]+fr+Qr)}],c=v[mn]>2?v[mn]-4:0,u=oe.createElement(Sn),f=oe.createElement(Ht),d=oe.createElement(er),h=oe.createElement(Tn+or),p=oe.createElement(Sn),g=oe.createElement(Ht),m=oe.createElement(Ut),b=oe.createElement(dn),w=oe.createElement(Br),E=oe.createElement(Sn);return{aC:function(){if(Wizard.d())return;let e=(prompt(Ee.getMessage("prompt"+Tr+"Name")+":")||"").trim();if(e)if(e.length>t)alert(Ee.getMessage(Ur+Tr+"CharLimit",[t])),m.selectedIndex=c;else if(Te.test(e)||e.startsWith(on)||e.startsWith("——"))alert(Ee.getMessage(Ur+Tr+"Reserved")),m.selectedIndex=c;else{for(let t=0;t<o.length;++t)if(o[t].n===e)return alert(Ee.getMessage(Ur+Tr+"Duplicate")),void(m.selectedIndex=c);N&&(b.disabled=!0,Wizard.sS(Ee.getMessage(ii+"SyncingCat"))),aa({type:"sC",data:{cat:{n:e,s:$r}}})}else m.selectedIndex=c},c:function(){q&&!q.closing&&(q.closing=!0,q.classList.remove(yr),setTimeout(Wizard.rS,200),Wizard.d(!0)||aa({type:"cH"}))},cr:function(){Wizard.d()||(Wizard.sS(Ee.getMessage(Ur+"Generating")),aa({type:"gR",data:m.value}))},d:function(t){if(e&&be?.id)return!1;try{return Wizard.iP(),!1}catch(e){return t||alert(Ee.getMessage(Fn+"UpdateAlert")),!0}},eC:function(e){if(e.preventDefault(),Wizard.d())return;let t=h.querySelector("["+ei+'="'+kl(this.value||d.value)+'"]');t&&!t.executing&&(t.executing=!0,aa({type:"eR",data:{catnow:+t.getAttribute(Tn+"-ci"),force:!0}},(e=>{be.lastError||(Wizard.rD(),delete t.executing,clearTimeout(q[Vr]),q[Vr]=setTimeout((()=>{y[Cn]&&1!==v[Cn]&&Wizard.c()}),2500))})))},gS:function(e){return`<${Br}>${e}</${Br}> `},iP:function(){e=be.connect({name:ke[22]}),e.onDisconnect.addListener(Wizard.hD),e.onMessage.addListener(Wizard.hM)},pC:function(e,t,r){let i;if(o.length=2,o=o.concat(t[bn]),c=Math.max(t[mn]-4,0),r===jn){o.push({k:"new",n:Ee.getMessage(vr+ke[18]+Tr+ke[18]+fr+"New")}),e.length=0;for(let t=1;t<o.length;++t)o[t].n.startsWith(on)||(i=oe.createElement(vr),i.value=o[t].k,i.text=o[t].n,t===c+1?i.selected=!0:t===o.length-1&&(i.className="menu-action"),e.add(i))}else{let r=new DocumentFragment;e.innerHTML="";for(let e,l=0;l<o.length;++l)o[l].n.startsWith(on)||t[wr][In+bn]&&o[l].s&&!Zl(o[l].s,AF_WIZARD[Ir+"Haystack"])||(e=l>1?l+3:l+1,i=oe.createElement(vr),i.value=o[l].n,i.setAttribute(Tn+"-ci",e),e===t[mn]?(i.value+=n,i.value===d.value+n&&(d.value+=n)):i.value+n===d.value&&(d.value=d.value.replace(n,""),Wizard.rD()),r.appendChild(i));e.appendChild(r)}},rD:function(){d.blur(),setTimeout((()=>{d.focus()}),50)},rS:function(){Wizard.sS(),b.disabled=!1,delete q.closing},sC:function(){"new"===this.value?Wizard.aC():c=this.selectedIndex},sS:function(e,t){isNaN(t)?(w.className="",w.textContent=e||""):(w.className=t?"warning":"success",w.textContent=e)},s:function(){if(!q)return;if(q.classList.contains(cr+"ed"))return clearTimeout(q[Vr]),Wizard.uS(),void q.classList.add(yr);let e=he.AF_WIZARD,t=q.attachShadow({mode:yr}),n=oe.createElement("link"),r=oe.createElement(er),a=oe.createElement(Pn),s=oe.createElement(Hr),o=oe.createElement(Hr),c=oe.createElement(Hr),C=oe.createElement(Hr),k=oe.createElement(dn);if(q.id=li,q.hidden=!0,q.onselectstart=function(){return!1},n.rel=jr+"sheet",n.href=be.getURL("css/"+ii+".css"),r.type=Qn,r.src=be.getURL(Qn+"s/icon24.png"),r.alt=we+" logo",y[Gr]&&(r.title=we+"\n"+Ee.getMessage(ii+"TT")),r.width=24,r.height=24,r.setAttribute(Mr,"link"),r.onclick=function(){aa({type:"oO"})},u.id=li+"-"+zt,f.id=li+"-"+zt+"-"+Ht,f.textContent=Ee.getMessage(Fn+"Execute"),f.setAttribute(Zt,li+"-"+zt+"-"+xn),f.onclick=Wizard.t,a.id=li+"-"+zt+"-"+xn,a.setAttribute(Mr,"region"),a.setAttribute(_t,li+"-"+zt+"-"+Ht),a.onsubmit=Wizard.eC,d.type="search",d.placeholder=Ee.getMessage(ii+"Search"+Tr+ke[18]),d.spellcheck=!1,y[Gr]&&(d.title=Ee.getMessage(ii+"Search"+Tr+"sTT")),d.setAttribute(or,li+"-"+bn+"-dl"),d.required=!0,d.oninput=Wizard.eC,Wizard.pC(h,v,zt),h.id=li+"-"+bn+"-dl",p.id=li+"-"+jn,g.id=li+"-"+jn+"-"+Ht,g.textContent=Ee.getMessage(ii+"Gen"),g.setAttribute(Zt,li+"-"+jn+"-"+xn),g.onclick=Wizard.t,s.id=li+"-"+jn+"-"+xn,s.setAttribute(Mr,"region"),s.setAttribute(_t,li+"-"+jn+"-"+Ht),o.id=li+"-"+Pr+"1",o.innerHTML=Wizard.gS(1)+Ee.getMessage(ii+"Fill"+(e[Ln]?"Field":"Form")),c.id=li+"-"+Pr+"2",c.innerHTML=Wizard.gS(2)+Ee.getMessage(ii+"Choose"+Tr)+": ",C.id=li+"-"+Pr+"3",C.innerHTML=Wizard.gS(3),Wizard.pC(m,v,jn),m.id=li+"-"+bn+"-sel",y[Gr]&&(m.title=Ee.getMessage(ii+"Choose"+Tr+"TT")),m.onchange=Wizard.sC,c.appendChild(m),b.type=dn,b.id=li+"-create",b.textContent=e[Ln]?i.replace(Or+ke[18],Or):i,y[Gr]&&(b.title=e[Ln]?l.replace(Lr,"rule"):l),b.onclick=Wizard.cr,C.appendChild(b),w.id=li+"-"+Ur,E.id=li+"-sub",E.className="warning",E.innerHTML=Ee.getMessage(ri+(e[zr]||"")),k.type=dn,k.id=li+"-close",k.textContent=" ",y[Gr]&&(k.title=Ee.getMessage(dn+"sClose")),k.onclick=Wizard.c,a.append(f,d,h),ge){let e=oe.createElement(dn);e.type="reset",e.className="reset",y[Gr]&&(e.title=Ee.getMessage(dn+"sClearTT")),e.innerHTML="&times;",a.appendChild(e),a.onreset=function(){d.focus()}}u.appendChild(a),s.append(g,o,c,C,w),p.appendChild(s),t.append(n,r,u,p,E,k),Ni.appendChild(q),Wizard.uS(),setTimeout((()=>{q.className=cr+"ed",setTimeout((()=>{q.className=cr+"ed "+yr,e[Zr]===jn?m.focus():d.focus()}),150)}),0),Wizard.iP()},sD:function(e){let t=q?.shadowRoot;if(!t)return;let n=!1;for(const t in e){switch(v[t]=e[t].newValue,t){case mn:case bn:n=!0;break;case wr:v[t][In+bn]!==e[t].oldValue[In+bn]&&(n=!0)}if(n)break}n&&(Wizard.pC(t.getElementById(li+"-"+bn+"-dl")||h,v,zt),Wizard.pC(t.getElementById(li+"-"+bn+"-sel")||m,v,jn))},t:function(){if(Wizard.d())return;let e=this.parentElement.parentElement;e.classList.toggle(br),e.classList.contains(br)?(y[Gr]&&(this.title=s),this.setAttribute(r,Rn)):(e.contains(d)?d.focus():e.contains(m)&&m.focus(),y[Gr]&&(this.title=a),this.setAttribute(r,Yr))},uS:function(){let e=q?.shadowRoot;if(!e)return;let t=he.AF_WIZARD,n=t[Zr]===jn,o="sub"===t[Zr];e.getElementById(li+"-"+Pr+"1").innerHTML=Wizard.gS(1)+Ee.getMessage(ii+"Fill"+(t[Ln]?"Field":"Form")),b.innerHTML=t[Ln]?i.replace(Or+ke[18],Or):i,y[Gr]&&(b.title=t[Ln]?l.replace(Lr,"rule"):l),Wizard.sS(),u.classList.toggle(br,n),p.classList.toggle(br,!n),y[Gr]&&(f.title=n?s:a,g.title=n?a:s),f.setAttribute(r,n?Rn:Yr),g.setAttribute(r,n?Yr:Rn),o&&(E.innerHTML=Ee.getMessage(ri+(t[zr]||""))),u.hidden=p.hidden=o,E.hidden=!o,n?m.focus():d.focus()},hD:function(){e=void 0},hM:function(e){switch(e[Zr]){case"eCB":if(!q)return;b.disabled=!1,e[Tn]?Wizard.sS(e[Tn],1):Wizard.sS();break;case"gR":{if(!q)return;let t=e[Tn];t.length?(b.disabled=!0,aa({type:"sR",data:{rules:t}}),Wizard.sS(Ee.getMessage(Ur+"Done"),0),clearTimeout(q[Vr]),q[Vr]=setTimeout((()=>{y[Cn]&&v[Cn]>0?Wizard.c():Wizard.rS()}),2500)):Wizard.sS(e.field?Ee.getMessage(Ur+"EnterValue"):Ee.getMessage(Ur+"NoChange"),1);break}}}}}(),Ce.onChanged.addListener(Wizard.sD)),be?.id&&fe&&oe[_r].startsWith(Ll(Wt))&&(P||(P=oe.getElementById(Nn+"-save-indicator-badge")),y["bi"+Fr]&&N&&c&&oe[_r].includes(c)?P&&!P.observer&&(P.observer=new MutationObserver((e=>{if(!be?.id)return P.observer.disconnect(),void delete P.observer;e.forEach((e=>{let t;for(let n=0;n<e.addedNodes.length;++n)t=e.addedNodes[n],t.querySelector("."+Nn+"-"+Fr+"-20")&&aa({type:"rD"})}))})),P.observer.observe(P,{childList:!0})):(P.observer?.disconnect(),delete P.observer)),oe.onkeydown=ol;let d=oe.querySelectorAll(er+"["+Zr+'="'+Cr+'"]');if(R)switch(v.reveal){case 0:d.forEach((e=>{e.onmouseenter=e.onmouseleave=null,e.onfocus=()=>da(e,!0),e.onblur=()=>da(e,!1)}));break;case 1:d.forEach((e=>{e.onfocus=e.onblur=null,e.onmouseenter=()=>da(e,!0),e.onmouseleave=()=>da(e,!1)}))}else d.forEach((e=>{e.onfocus=e.onblur=e.onmouseenter=e.onmouseleave=null}));if(G?.remove(),A){B=v[nn+kn],F=B.length,J=(j=B+B).length,K={};for(const e of v[Kr].sort()){let t=e.split("\n")[0].trim().split(/ *> */).pop(),n=e.replace(mt,"");K[t]=n}let e=oe.createDocumentFragment();G=oe.createElement(Tn+or);for(const t in K){let n=oe.createElement(vr);n.value=Jl(K[t]).replace(Ze,"\\\\n").replace(Ge,"\\n"),n.text=B+t.toLowerCase()+B,ge&&(n.text+=" "+n.value),e.appendChild(n)}G.id="af-dl-"+i,G.appendChild(e),Ni.appendChild(G),Y=function(e){let t=!1;for(const n of G.options)if(n.value===e){t=!0;break}return t},he.oninput=ma}else oe.oninput=null,V?.remove(),K=V=void 0;if(S){let e=ea(ne);se=jl(ea(ee)),e&&e.click(),oa()}L=!0,oe.dispatchEvent(new Event("init")),e()})).catch((e=>{n(e)}))})).catch((e=>{throw e}))}function Vl(e,t){if(be?.id&&e)for(let n=0,r=e.length;n<r;++n){let r=e[n],i=r.type,l=al(i);if(!(r.hidden||r.readOnly||i===Kn||r.nodeName===Sn.toUpperCase()&&(il||ll)))if(r[cn]=y[cn]&&i!==Cr,r.nodeName===Zn){if(!ga(r))continue;r[Fr]=t,r.onload=function(){Vl([this],this[Fr])};let e=Rl(r);Array.isArray(e)?Vl(e,t):typeof e===qr&&Gl(r,e)}else{if(!t){let e=ki.get(r);l?void 0===e?(r[Xn]=r.checked,ki.set(r,r.checked)):r[Xn]=e:r.multiple?void 0===e?(r[Xn]=Bl(r),ki.set(r,r[Xn])):r[Xn]=e:(r.isContentEditable?Gl(r,Dl(r.innerHTML)):void 0===e?(r[Xn]=r.value,ki.set(r,r.value)):r[Xn]=e,r[_n]=typeof r.className===qr?r.className.trim():"")}r.oninput=r[cn]?vl(hl):null}}}function Gl(e,t){if(void 0!==e[Vr]&&!e[Fr])return;let n,r,i=0,l=0,a=function(e){if(e.isContentEditable)n=e,r=!0;else try{n=e.contentDocument&&e.contentDocument.body,r=e.contentDocument&&e.contentDocument.readyState===kn}catch(e){return}if(n)if(e[Fr]||r&&Dl(n.innerHTML)===e[Xn]){if(e[Fr]||3==++l)return e.isContentEditable||(n.oninput=e[cn]?vl(hl):null,n.setAttribute(Vn,Rn),n.onblur=ya,n.onfocus=va),e[Wn]=!0,void(e[Fr]||e.dispatchEvent(nl))}else{if(!e[Fr]){let t=Dl(n.innerHTML);t&&(e[Xn]=t)}l=0}++i<100&&(clearTimeout(e[Vr]),e[Vr]=setTimeout((()=>a(e)),100))};t&&(e[Xn]=t),a(e)}function Yl(e){return null===e.offsetParent}function Zl(e,t){if(Ql(e))return!1;let n=function(e){if(e.startsWith("//")||!it.test(e))return null;try{let t=e.lastIndexOf("/"),n=e.slice(1,t),r=e.slice(t+1);return new RegExp(n,r.replace(lt,"")+"m")}catch(e){return null}}(e);if(e=e?.toLowerCase(),n)return n.test(t.join("\n"));if(e?.startsWith('"')&&e?.endsWith('"')){e=e.slice(1,-1).trim();for(const n of t)if(n.toLowerCase().trim()===e)return!0}else for(const n of t)if(n.toLowerCase().includes(e))return!0;return!1}function Ql(e=""){return e.startsWith("//")||e.startsWith("/html")&&!it.test(e)}function _l(e,t){Ei.push(e),pa(0),wl(Or+" "+e+' in profile "'+(g[v[Lr][e].c]?g[v[Lr][e].c].n:Qr)+'" executed:',t)}function Xl(e,t=1e3){return new Promise((n=>{let r=Date.now(),i=()=>{let l=Ql(e)?ta(e):ea(e);l?n(l):Date.now()-r>=t?n(null):setTimeout(i,100)};i()}))}function ea(e){try{return e.startsWith("#")?oe.getElementById(e.slice(1)):oe.querySelector(e)}catch(e){return null}}function ta(e){try{return oe.evaluate(e,oe,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}catch(e){return null}}function na(e,t){return[].slice.call((t||oe).querySelectorAll(e))}function ra(e=0,t){return Math.floor(Math.random()*(t-e+1)+e)}function ia(e){let t=fl(e);t.length&&(aa({type:"sR",data:{backup:!0,rules:t}}),H=void 0)}function la(e,t){if(!e)return!1;if(e.nodeType===Node.TEXT_NODE)return e.textContent.trim()===t&&(e.parentElement?.click(),!0);for(const n of e.childNodes)if(la(n,t))return!0;return!1}function aa(e,t){be?.id&&be.sendMessage(e,typeof t===Bn?t:function(){be.lastError})}function sa(e){be?.id&&aa({type:"sU",data:e})}function oa(){try{let n=ea(ne);if(Xi||!n||Yl(n)||(n.click(),Xi=!0),jl(ea(ee))!==se&&(el=!0),++_i>e&&(el=!0),el)return;{let e=ea(Z),n=ea(X),r=ea(ie),i=ea(le);e&&!Yl(e)&&ea(re)&&e.click(),!tl&&Wi===n?.src&&r||ea(Q)?.textContent&&r&&!r.disabled?r.click():tl||!i||Yl(i)||ea(_)?.value||Wi===n?.src||(tl=!0,Wi=n.src,t=Wi,fetch(Ll(St),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({audioUrl:t})}).then((e=>{if(!e.ok)throw new Error(e.status);return e.json()})).then((e=>{let t=(e.response?.text||"").replace(".","");if(!t)throw new Error(`No ${Jr} ${Wr}`);let n=ea(_),r=ea(ae);if(Wi!==ea(X)?.src||!n||n.value||"none"!==ea(Z)?.style.display||!r)throw new Error(`Could not locate ${Jr} ${er}`);n.value=t,r.click()})).catch((e=>{})).finally((()=>{tl=!1})))}if(ea(te)?.textContent)return}catch(e){return}var t;setTimeout(oa,ra(1750,2250))}function ca(e,t){return new Promise((async(n,r)=>{let i;try{if(typeof e===qr)i=wi.includes(e)?await Ce.local.get(e):await Ce.sync.get(e);else if(Array.isArray(e)){let t=[],n=[];for(const r of e)wi.includes(r)?t.push(r):n.push(r);i=Object.assign({},await Ce.local.get(t),await Ce.sync.get(n))}else typeof e===Bn&&(t=e),i=Object.assign({},await Ce.local.get(),await Ce.sync.get());typeof t===Bn&&t(i),n(i)}catch(e){r(e.message)}})).catch((e=>{throw e}))}function ua(e){return e.replace(Ae,"").trim()}function fa(e,t,n){let r,i=0;if("boolean"!=typeof e.checked)return 0;switch(r=e.checked,t){case 0:if(r){if(!I&&10-+E.toString(16)<=0&&!C)return sa(),-1;e.click(),_l(n,e),++i}break;case 1:if(!r){if(!C&&10-+E.toString(16)<=0&&!I)return sa(),-1;e.click(),_l(n,e),++i}}return i}function da(e,t){t&&e.type!==Jr?e.type=Jr:t||e.type===Cr||(e.type=Cr)}function ha(e,t){return 1===e.filter((e=>e===t)).length}function pa(e){be?.id&&aa({type:"uS",data:{fields:e,filled:Ei}})}function ga(e){try{return e.offsetParent&&e.clientWidth>1&&e.clientHeight>1&&!ue&&(!!e.srcdoc||(!e.src||e.src.startsWith(location.origin)||st.test(e.src))&&(!e.contentDocument||!e.contentDocument.querySelector(Mt+","+Ut+","+Yn)))}catch(e){return!1}}function ma(e){let t=e.target,n=t.value||t.textContent||"",r=t.isContentEditable;if(!n||!r&&!yi.includes(t.type))return;let i=new cl(t),l=i.getPos();if(n.slice(l-J,l)===j){if(!V){let e=i.getXY(),n={position:"fixed",top:e.top+2+"px",left:e.left+2+"px",width:nn,border:0,fontFamily:"monospace",opacity:0,padding:0},a=0,s=function(){let e=this.value;Y(e)&&(e=e.replace(Qe,"\v\vn"),e=e.replace(Ze,"\n"),e=e.replace(Ye,"\\n"),r?i.setText(e,this[xr]+J,J):i.setText(e,l-J,l+this[xr]),setTimeout((()=>{t.focus()}),0))},o=function(){let e=this.value;a=e.length,ge||(this.size=a+2),r?(i.setText(e,this[xr]||0),this.focus()):i.setText(e,l,l+(this[xr]||a-1)),this[xr]=a,ge&&Y(e)&&(r||--this[xr],this.dispatchEvent(new Event(vn,{bubbles:!0})))},c=function(e){switch(e.key){case sn:this.value.length||f(e.key);break;case On:f(e.key)}this[nr]=!0},u=function(){delete this[nr]},f=function(e){i[tr]||V[nr]&&V[Vr]||(clearTimeout(V[Vr]),V[Vr]=setTimeout((()=>{V&&(V.remove(),V=null,e===On&&t.focus())}),0),r&&e!==sn&&i.setText(),t.style.outline="",e===sn&&t.focus())};V=oe.createElement(er),Object.keys(n).forEach((e=>{V.style[e]=n[e]})),V.setAttribute(or,G?.id),V.size=ge?30:3,V.spellcheck=!1,V.tabIndex=-1,V.addEventListener(un,f),V.addEventListener(vn,s),V.addEventListener(er,o),V.addEventListener(ar,c),V.addEventListener(sr,u),t.style.outline="2px dotted rgb(252 172 57)",Ni.appendChild(V),V.focus()}}else if(n.slice(l-F,l)===B){if(void 0!==t.lastTriggerPos){let e=function(e,t){return t<1||t>e.length?"":e.lastIndexOf(B,t-2)+1}(n,l),t=n.slice(e,l-1).toLowerCase();K&&Object.hasOwn(K,t)&&(r?i.setText(K[t],t.length+J):i.setText(K[t],e-B.length,l))}t.lastTriggerPos=l}}function ba(){if(be?.id)try{aa({type:"rC",data:{force:!0}})}catch(e){}}function ya(){be?.id&&this?.setAttribute&&this.setAttribute(Vn,Rn)}function va(){be?.id&&this?.setAttribute&&this.setAttribute(Vn,Yr)}function wa(e,t,n){if(!be?.id)return;let r=e[Tn];switch(e[Zr]){case ke[0]:if(M)wl(Ee.getMessage("debugExceptions",bi));else if(v){if(sl())return void sa();let e=function(){s=Sl(r[mn]),T=!0,O=!0,m=void 0,ul(s)};L?e():oe.addEventListener("init",e,Ti)}break;case"cH":bl();break;case ke[2]:{let e=H?fl(r[pn]):null===H?[]:dl(r[pn]);e.length&&aa({type:"aR",data:e}),n({field:!!H});break}case"iT":{let e=oe.activeElement;if("BODY"===e.nodeName||e.nodeName===Zn)return;ca(Kr,(async t=>{let n=t[Kr];for(let t=0;t<n.length;++t)if(r.id===n[t].split("\n")[0].trim().replace(xe,"_").toLowerCase()){let r=n[t].replace(mt,"");if(y.vars&&(r=Jl(r)),e.isContentEditable){let e=oe.createElement(Hr),t=getSelection(),n=t.getRangeAt(0);n.deleteContents(),e.innerHTML=r.replace(Ge,"<br>"),n.insertNode(e),n.setStartAfter(e),n.collapse(!0),t.removeAllRanges(),t.addRange(n)}else{if(e[Xn]=e.value,await Tl(e,[ar]),null===e.selectionEnd)e.value+=r;else{let t=e.selectionStart;e.value=e.value.slice(0,t)+r+e.value.slice(e.selectionEnd),e.setSelectionRange(t+r.length,t+r.length)}await Tl(e,[er,sr,vn])}break}}));break}case ke[15]:n({exists:!0});break;case"sW":be?.id||n({}),bl(),H=r[Ln]?(fe&&!r[qn]||r[qn])&&oe.activeElement.matches(Ot)?function(e){if(e.getAttribute(Vn)===Rn)return;let t;if(!e.type)if(e.nodeName===Zn)ga(e)?(t=e.contentDocument,e=t&&t.activeElement||null):e=null,e&&!e.matches(Lt)&&(e=e.ownerDocument.defaultView.frameElement||null);else for(;e&&"BODY"!==e.nodeName&&e.getAttribute(xn+Ln)!==Yr;)e=e.parentElement;return e&&(U=e.nodeName===Zn?t&&t.body:e)&&void 0===U.initialStyle&&(U.initialStyle=U.getAttribute(jr),setTimeout((()=>{U.setAttribute(jr,"background:#cadbf2!important;color:#000!important")}),0)),e}(oe.activeElement):null:void 0,fe&&(he.AF_WIZARD={editable:r[Ln],siteHaystack:Ci,slug:r[zr],type:r[Zr]}),he.Wizard&&q&&(q.classList.contains(yr)?Wizard.uS():fe&&Wizard.s());break;case ke[18]:{if(!v)return;let t=y[cn];Kl(e[Zr]).then((()=>{y[cn]!==t&&Vl(na(Ot),!0)}),(e=>{}));break}}}!function t(){if(be?.id&&Xr&&(innerWidth>1||innerHeight>1)){try{l=localStorage}catch(e){l=he}Kl().then((async()=>{await El(100);let e=na(Ot);pa(e.length),Vl(e);try{if(l[Kt]&&k>1)try{xi=JSON.parse(l[Kt])}catch(e){}}catch(e){}let t=T?s:void 0,n=Ol();x=new Date,setTimeout((e=>{}),250,{catexe:t,fields:e}),O||(n?setTimeout((e=>{ul(e[gn],e[$n])}),1e3*n,{catexe:t,fields:e}):ul(t,e)),yl(oe)}),(e=>{wl(e)})),be.onMessage.addListener(wa),fe&&!top.FencedFrameElement&&(he.onbeforeunload=ba)}else++Ai<=10*e&&setTimeout(t,100)}();
